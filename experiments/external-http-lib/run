#!/bin/bash

cd "$(dirname "$0")"

TITLE:() {
  color="\033[34m"
  endcolor="\033[0m"
  text="-- $* --"
  printf -- "${color}${text}${endcolor}\n"
}

TITLE: ENSURING PARSER SERVER IS STARTED
rake parser:server:restart

TITLE: RUNNING HAXE VERSION
haxe -main "ExternalHttp" -neko "ExternalHttp.hx.n" || exit $!
neko "ExternalHttp.hx.n" || exit $!

TITLE: NODE
haxe -main "ExternalHttp.hx" -D node -js "ExternalHttp.node.js" || exit $!
node "ExternalHttp.node.js" || exit $!

TITLE: BROWSER
haxe -main "ExternalHttp.hx" -js "ExternalHttp.browser.js" || exit $!
cat <<HTML > page.html
<!doctype html>
<html>
  <head>
    <title>Hello world js example</title>
  </head>
  <body>
    <script src="ExternalHttp.browser.js"></script>
    <p>Check the js console for output</p>
  </body>
</html>
HTML
open "page.html" # idk if non-mac's have an "open" command
